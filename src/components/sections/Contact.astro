---
import Input from '../primitives/Input.astro';
import Button from '../primitives/Button.astro';

interface Props {
  title: string;
  subtitle?: string;
  formAction?: string;
  formMethod?: 'GET' | 'POST';
  fields?: Array<{
    name: string;
    label: string;
    type?: 'text' | 'email' | 'tel' | 'url';
    placeholder?: string;
    required?: boolean;
  }>;
  messageField?: {
    name?: string;
    label?: string;
    placeholder?: string;
    required?: boolean;
    rows?: number;
  };
  submitButton?: {
    label?: string;
    variant?: 'primary' | 'secondary';
  };
  contactInfo?: Array<{
    icon?: string;
    label: string;
    value: string;
    href?: string;
  }>;
  layout?: 'form-only' | 'with-info';
  class?: string;
}

const {
  title,
  subtitle,
  formAction = '#',
  formMethod = 'POST',
  fields = [
    { name: 'name', label: 'Name', type: 'text', required: true },
    { name: 'email', label: 'Email', type: 'email', required: true },
  ],
  messageField = {
    name: 'message',
    label: 'Message',
    placeholder: 'Your message...',
    required: true,
    rows: 5,
  },
  submitButton = {
    label: 'Send Message',
    variant: 'primary',
  },
  contactInfo,
  layout = 'form-only',
  class: className = '',
} = Astro.props;

const sectionClasses = [
  'py-16 md:py-24 bg-white',
  className,
].filter(Boolean).join(' ');

const hasContactInfo = layout === 'with-info' && contactInfo && contactInfo.length > 0;
---

<section class={sectionClasses}>
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">
    <div class="text-center mb-12 lg:mb-16">
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold font-heading text-brand-primary mb-4">
        {title}
      </h2>

      {subtitle && (
        <p class="text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto">
          {subtitle}
        </p>
      )}
    </div>

    <div class={hasContactInfo ? 'grid grid-cols-1 lg:grid-cols-2 gap-12' : 'max-w-2xl mx-auto'}>
      {/* Contact form */}
      <div>
        <form action={formAction} method={formMethod} class="space-y-6">
          {fields.map((field) => (
            <Input
              type={field.type || 'text'}
              name={field.name}
              label={field.label}
              placeholder={field.placeholder}
              required={field.required}
            />
          ))}

          {/* Message textarea */}
          <div>
            <label
              for={messageField.name}
              class="block text-sm font-medium text-gray-700 mb-2"
            >
              {messageField.label}
              {messageField.required && (
                <span class="text-red-500 ml-1" aria-label="required">*</span>
              )}
            </label>

            <textarea
              id={messageField.name}
              name={messageField.name}
              rows={messageField.rows}
              placeholder={messageField.placeholder}
              required={messageField.required}
              class="w-full px-4 py-3 rounded-lg border border-gray-300 bg-white text-gray-900 placeholder-gray-500 transition-colors focus:outline-none focus:border-brand-accent focus-visible:ring-2 focus-visible:ring-brand-accent focus-visible:ring-offset-2 disabled:bg-gray-100 disabled:cursor-not-allowed resize-y min-h-[120px]"
            ></textarea>
          </div>

          <div class="pt-2">
            <Button
              type="submit"
              variant={submitButton.variant}
              size="lg"
              class="w-full sm:w-auto"
            >
              {submitButton.label}
            </Button>
          </div>
        </form>
      </div>

      {/* Contact info (optional) */}
      {hasContactInfo && (
        <div class="space-y-8">
          <div>
            <h3 class="text-2xl font-bold font-heading text-gray-900 mb-6">
              Contact Information
            </h3>

            <div class="space-y-4">
              {contactInfo!.map((info) => (
                <div class="flex items-start gap-4">
                  {info.icon && (
                    <div class="text-2xl flex-shrink-0 mt-1">
                      {info.icon}
                    </div>
                  )}

                  <div>
                    <div class="text-sm font-medium text-gray-600 mb-1">
                      {info.label}
                    </div>

                    {info.href ? (
                      <a
                        href={info.href}
                        class="text-gray-900 hover:text-brand-accent transition-colors"
                      >
                        {info.value}
                      </a>
                    ) : (
                      <div class="text-gray-900">
                        {info.value}
                      </div>
                    )}
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      )}
    </div>
  </div>
</section>
