---
/**
 * About Section Component
 *
 * Three layout options:
 * - 'single': Simple centered content
 * - 'two-columns': Content split into multiple columns
 * - 'with-image': Two-column layout with image + content
 *
 * Features:
 * - Optional subtitle
 * - Rich HTML content support
 * - Optional statistics display
 * - Flexible column layouts
 */
interface Props {
  title: string;
  subtitle?: string;
  content?: string;
  columns?: Array<{
    title?: string;
    content: string;
  }>;
  image?: {
    src: string;
    alt: string;
    position?: 'left' | 'right';
  };
  stats?: Array<{
    value: string;
    label: string;
  }>;
  layout?: 'single' | 'two-columns' | 'with-image';
  columnsCount?: 2 | 3;
  class?: string;
}

const {
  title,
  subtitle,
  content,
  columns,
  image,
  stats,
  layout = 'single',
  columnsCount = 2,
  class: className = '',
} = Astro.props;

const imagePosition = image?.position || 'right';
const imageOnLeft = imagePosition === 'left';

const hasColumns = columns && columns.length > 0;

const columnsGridClasses = {
  2: 'grid-cols-1 md:grid-cols-2',
  3: 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3',
};

const sectionClasses = [
  'py-16 md:py-24 bg-gray-50',
  className,
].filter(Boolean).join(' ');

// Determine header alignment based on layout
const headerCentered = layout === 'single' || layout === 'two-columns';
---

<section class={sectionClasses}>
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl">
    {/* Header */}
    <div class={headerCentered ? 'text-center mb-12 lg:mb-16' : 'mb-8'}>
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold font-heading text-brand-primary mb-4">
        {title}
      </h2>

      {subtitle && (
        <p class="text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto">
          {subtitle}
        </p>
      )}
    </div>

    {/* Layout: with-image */}
    {layout === 'with-image' && (
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center">
        {image && (
          <div class={imageOnLeft ? 'order-first' : 'order-first lg:order-last'}>
            <img
              src={image.src}
              alt={image.alt}
              class="w-full h-auto rounded-lg shadow-lg"
              loading="lazy"
              decoding="async"
            />
          </div>
        )}

        <div class={imageOnLeft ? 'order-last' : ''}>
          {content && (
            <div class="prose prose-lg max-w-none mb-8 text-gray-700" set:html={content} />
          )}

          {hasColumns && (
            <div class="space-y-6">
              {columns!.map((col) => (
                <div>
                  {col.title && (
                    <h3 class="text-xl font-semibold text-gray-900 mb-3">
                      {col.title}
                    </h3>
                  )}
                  <div class="prose prose-lg max-w-none text-gray-700" set:html={col.content} />
                </div>
              ))}
            </div>
          )}

          {stats && stats.length > 0 && (
            <div class="grid grid-cols-2 md:grid-cols-3 gap-6 mt-8">
              {stats.map((stat) => (
                <div class="text-center lg:text-left">
                  <div class="text-3xl sm:text-4xl font-bold text-brand-primary mb-2">
                    {stat.value}
                  </div>
                  <div class="text-sm sm:text-base text-gray-600">
                    {stat.label}
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>
      </div>
    )}

    {/* Layout: two-columns or single */}
    {(layout === 'two-columns' || layout === 'single') && (
      <div>
        {/* Single content block */}
        {content && !hasColumns && (
          <div class="prose prose-xl max-w-4xl mx-auto text-gray-700" set:html={content} />
        )}

        {/* Multiple columns */}
        {hasColumns && (
          <div class={`grid ${columnsGridClasses[columnsCount]} gap-8 lg:gap-12 max-w-6xl mx-auto`}>
            {columns!.map((col) => (
              <div>
                {col.title && (
                  <h3 class="text-2xl font-bold font-heading text-gray-900 mb-4">
                    {col.title}
                  </h3>
                )}
                <div class="prose prose-lg max-w-none text-gray-700" set:html={col.content} />
              </div>
            ))}
          </div>
        )}

        {/* Stats */}
        {stats && stats.length > 0 && (
          <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mt-12 max-w-5xl mx-auto">
            {stats.map((stat) => (
              <div class="text-center">
                <div class="text-3xl sm:text-4xl font-bold text-brand-primary mb-2">
                  {stat.value}
                </div>
                <div class="text-sm sm:text-base text-gray-600">
                  {stat.label}
                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    )}
  </div>
</section>
